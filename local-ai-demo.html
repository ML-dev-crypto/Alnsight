<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AInSight - Local AI Demo (Works Offline!)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin-top: 10px;
        }

        .status-online {
            background: #10b981;
            color: white;
        }

        .status-offline {
            background: #f59e0b;
            color: white;
        }

        .status-loading {
            background: #3b82f6;
            color: white;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .demo-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .demo-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .demo-card .icon {
            font-size: 1.5em;
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.95em;
            font-family: inherit;
            resize: vertical;
            min-height: 100px;
            margin-bottom: 10px;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .output {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            min-height: 60px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .output.success {
            border-color: #10b981;
            background: #ecfdf5;
        }

        .output.error {
            border-color: #ef4444;
            background: #fef2f2;
            color: #dc2626;
        }

        .loading-container {
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
        }

        .info-box {
            background: #eff6ff;
            border: 2px solid #3b82f6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: #1e40af;
        }

        .info-box strong {
            display: block;
            margin-bottom: 5px;
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-list li::before {
            content: "‚úì";
            color: #10b981;
            font-weight: bold;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† AInSight Local AI Demo</h1>
            <p>All AI runs in your browser - No internet required after initial setup!</p>
            <span id="statusBadge" class="status-badge status-loading">Loading AI Models...</span>
        </div>

        <div id="loadingSection" class="loading-container">
            <div class="loading-spinner"></div>
            <h3>Initializing AI Models...</h3>
            <p>Downloading and caching models for offline use. This only happens once!</p>
            <div id="progressBars"></div>
        </div>

        <div class="info-box">
            <strong>üéâ How This Works:</strong>
            <ul class="feature-list">
                <li>AI models run 100% in your browser using Transformers.js</li>
                <li>Models are cached after first download - works offline forever!</li>
                <li>No data sent to any server - complete privacy</li>
                <li>Try disconnecting your internet after loading - it still works!</li>
            </ul>
        </div>

        <div id="demoContent" class="demo-grid" style="display: none;">
            <!-- Document Summarization -->
            <div class="demo-card">
                <h3><span class="icon">üìö</span> Document Summarizer</h3>
                <textarea id="summaryInput" placeholder="Paste a long document here to summarize...">The quarterly review meeting was held on November 5th, 2025. The team discussed the progress of the AInSight project. Key accomplishments include the completion of the backend API with authentication and user management, the admin dashboard with analytics visualization, and the mobile app structure. The team identified several challenges including the need for better offline AI model integration and voice-to-text functionality. Action items include implementing the RunAnywhere SDK integration, adding encrypted P2P chat functionality, and conducting security audits. The project is on track for the Q1 2026 launch. Budget concerns were raised regarding cloud infrastructure costs, prompting the decision to prioritize on-device AI processing.</textarea>
                <button onclick="summarizeText()">Summarize</button>
                <div id="summaryOutput" class="output"></div>
            </div>

            <!-- Email Drafter -->
            <div class="demo-card">
                <h3><span class="icon">‚úâÔ∏è</span> Email Drafter</h3>
                <textarea id="emailInput" placeholder="Describe what you want to write...">I need to inform the team about the successful completion of the AInSight AI integration and schedule a demo meeting for next week</textarea>
                <button onclick="draftEmail()">Draft Email</button>
                <div id="emailOutput" class="output"></div>
            </div>

            <!-- Sentiment Analysis -->
            <div class="demo-card">
                <h3><span class="icon">üòä</span> Sentiment Analyzer</h3>
                <textarea id="sentimentInput" placeholder="Enter text to analyze sentiment...">I'm really excited about this new AI project! The team has been incredibly supportive and the technology is amazing.</textarea>
                <button onclick="analyzeSentiment()">Analyze Sentiment</button>
                <div id="sentimentOutput" class="output"></div>
            </div>

            <!-- Task Extraction -->
            <div class="demo-card">
                <h3><span class="icon">‚úì</span> Task Extractor</h3>
                <textarea id="taskInput" placeholder="Paste meeting notes to extract tasks...">Meeting Notes: We need to implement the voice-to-text feature by end of month. John will work on the mobile UI redesign. Sarah needs to review the security documentation. Schedule a follow-up meeting with the client next Tuesday.</textarea>
                <button onclick="extractTasks()">Extract Tasks</button>
                <div id="taskOutput" class="output"></div>
            </div>

            <!-- Code Generator -->
            <div class="demo-card">
                <h3><span class="icon">üíª</span> Code Assistant</h3>
                <textarea id="codeInput" placeholder="Describe code you need...">// Function to calculate fibonacci numbers
function fibonacci(n) {</textarea>
                <button onclick="generateCode()">Generate Code</button>
                <div id="codeOutput" class="output"></div>
            </div>

            <!-- Q&A -->
            <div class="demo-card">
                <h3><span class="icon">‚ùì</span> Question Answerer</h3>
                <textarea id="contextInput" placeholder="Provide context...">AInSight is an enterprise AI system that runs completely offline. It includes a web dashboard for administrators and a mobile app for employees. The system uses local AI models to provide document summarization, email drafting, and task management without sending any data to external servers.</textarea>
                <textarea id="questionInput" placeholder="Ask a question about the context..." style="min-height: 60px;">What does AInSight do?</textarea>
                <button onclick="answerQuestion()">Answer Question</button>
                <div id="qaOutput" class="output"></div>
            </div>
        </div>
    </div>

    <script type="module">
        import localAI from './js/local-ai.js';

        // Track progress
        window.addEventListener('ai-model-progress', (e) => {
            const { model, progress } = e.detail;
            updateProgress(model, progress);
        });

        function updateProgress(model, progress) {
            let progressContainer = document.getElementById('progressBars');
            let progressBar = document.getElementById(`progress-${model}`);
            
            if (!progressBar) {
                progressContainer.innerHTML += `
                    <div style="margin: 10px 0;">
                        <div style="font-size: 0.9em; margin-bottom: 5px;">${model}</div>
                        <div class="progress-bar">
                            <div id="progress-${model}" class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>
                `;
                progressBar = document.getElementById(`progress-${model}`);
            }
            
            if (progress.progress) {
                progressBar.style.width = progress.progress + '%';
            }
        }

        // Initialize AI on page load
        async function initializeAI() {
            try {
                const statusBadge = document.getElementById('statusBadge');
                statusBadge.textContent = 'Downloading AI Models...';
                statusBadge.className = 'status-badge status-loading';

                // Load all models
                await localAI.initialize(['summarizer', 'textGenerator', 'sentiment', 'qa', 'code']);

                // Hide loading, show content
                document.getElementById('loadingSection').style.display = 'none';
                document.getElementById('demoContent').style.display = 'grid';

                // Update status
                updateStatus();

                console.log('‚úÖ All systems ready!');
            } catch (error) {
                console.error('Failed to initialize:', error);
                document.getElementById('loadingSection').innerHTML = `
                    <h3 style="color: #ef4444;">‚ùå Failed to load AI models</h3>
                    <p>${error.message}</p>
                    <button onclick="location.reload()">Retry</button>
                `;
            }
        }

        function updateStatus() {
            const statusBadge = document.getElementById('statusBadge');
            const status = localAI.getStatus();
            
            if (!status.initialized) {
                statusBadge.textContent = 'Initializing...';
                statusBadge.className = 'status-badge status-loading';
            } else if (status.online) {
                statusBadge.textContent = 'üü¢ Online & Ready';
                statusBadge.className = 'status-badge status-online';
            } else {
                statusBadge.textContent = 'üü° Offline Mode (Working!)';
                statusBadge.className = 'status-badge status-offline';
            }
        }

        // Demo functions
        window.summarizeText = async function() {
            const input = document.getElementById('summaryInput').value;
            const output = document.getElementById('summaryOutput');
            
            output.textContent = 'Processing...';
            output.className = 'output';
            
            const result = await localAI.summarizeDocument(input);
            
            if (result.success) {
                output.textContent = `üìù Summary:\n\n${result.summary}\n\nüìä Stats: Reduced from ${result.originalLength} to ${result.summaryLength} characters (${result.compressionRatio} of original)`;
                output.className = 'output success';
            } else {
                output.textContent = `Error: ${result.error}`;
                output.className = 'output error';
            }
        };

        window.draftEmail = async function() {
            const input = document.getElementById('emailInput').value;
            const output = document.getElementById('emailOutput');
            
            output.textContent = 'Drafting...';
            output.className = 'output';
            
            const result = await localAI.draftEmail(input, 'professional');
            
            if (result.success) {
                output.textContent = `‚úâÔ∏è Draft:\n\n${result.text}`;
                output.className = 'output success';
            } else {
                output.textContent = `Error: ${result.error}`;
                output.className = 'output error';
            }
        };

        window.analyzeSentiment = async function() {
            const input = document.getElementById('sentimentInput').value;
            const output = document.getElementById('sentimentOutput');
            
            output.textContent = 'Analyzing...';
            output.className = 'output';
            
            const result = await localAI.analyzeSentiment(input);
            
            if (result.success) {
                const emoji = result.sentiment === 'POSITIVE' ? 'üòä' : 'üòü';
                output.textContent = `${emoji} Sentiment: ${result.sentiment}\nüìä Confidence: ${result.confidence}`;
                output.className = 'output success';
            } else {
                output.textContent = `Error: ${result.error}`;
                output.className = 'output error';
            }
        };

        window.extractTasks = async function() {
            const input = document.getElementById('taskInput').value;
            const output = document.getElementById('taskOutput');
            
            output.textContent = 'Extracting tasks...';
            output.className = 'output';
            
            const result = await localAI.extractTasks(input);
            
            if (result.success) {
                output.textContent = `‚úì Extracted Tasks:\n\n${result.tasks.join('\n')}`;
                output.className = 'output success';
            } else {
                output.textContent = `Error: ${result.error}`;
                output.className = 'output error';
            }
        };

        window.generateCode = async function() {
            const input = document.getElementById('codeInput').value;
            const output = document.getElementById('codeOutput');
            
            output.textContent = 'Generating code...';
            output.className = 'output';
            
            const result = await localAI.generateCode(input);
            
            if (result.success) {
                output.textContent = `üíª Generated Code:\n\n${result.code}`;
                output.className = 'output success';
            } else {
                output.textContent = `Error: ${result.error}`;
                output.className = 'output error';
            }
        };

        window.answerQuestion = async function() {
            const context = document.getElementById('contextInput').value;
            const question = document.getElementById('questionInput').value;
            const output = document.getElementById('qaOutput');
            
            output.textContent = 'Finding answer...';
            output.className = 'output';
            
            const result = await localAI.answerQuestion(question, context);
            
            if (result.success) {
                output.textContent = `üí° Answer: ${result.answer}\n\nüìä Confidence: ${result.confidence}`;
                output.className = 'output success';
            } else {
                output.textContent = `Error: ${result.error}`;
                output.className = 'output error';
            }
        };

        // Monitor online/offline status
        window.addEventListener('online', updateStatus);
        window.addEventListener('offline', updateStatus);

        // Start initialization
        initializeAI();
    </script>
</body>
</html>
